---
title: "will_paginate query with per_page working in rails3"
date: 2011-01-21
created_at: 2011-01-21T16:27:55Z
updated_at: 2011-01-21T16:27:55Z
---

<strong>will_paginate_in_rails3.example.rb</strong>

    @articles = Article.
      select('articles.*, (SUM(votes.vote = 1)/COUNT(votes.vote)) votes_ratio, COUNT(votes.vote) votes_num').
      joins(:votes).
      group('articles.id').
      having('votes_num >= 5 AND votes_ratio >= 0.8').
      order('votes_ratio DESC, votes_num DESC').
      paginate(:page => params[:page], :per_page => Article.per_page)


[fork or comment at github](https://gist.github.com/789923)
